
SQL_v1 = [
    r'''CREATE TABLE IF NOT EXISTS `certificate_data` (
  `id` int(10) NOT NULL AUTO_INCREMENT,
  `du_id` int(10) NOT NULL,
  `version` int(10) DEFAULT '1',
  `set_version` int(10) NOT NULL,
  `name` varchar(255) NOT NULL,
  `cert_pem` mediumtext,
  `private_key_pem` mediumtext,
  PRIMARY KEY (`id`),
  UNIQUE KEY `set_version` (`du_id`,`set_version`,`name`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE utf8_unicode_ci''',


    r'''CREATE TABLE IF NOT EXISTS `customer_data` (
  `id` int(10) NOT NULL AUTO_INCREMENT,
  `version` int(10) DEFAULT '1',
  `admin_user` varchar(255) NOT NULL,
  `shortname` varchar(255) NOT NULL,
  `fullname` varchar(255) NOT NULL,
  `uuid` varchar(36) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `shortname` (`shortname`),
  UNIQUE KEY `uuid` (`uuid`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE utf8_unicode_ci''',


    r'''CREATE TABLE IF NOT EXISTS `du_metadata` (
  `id` int(10) NOT NULL AUTO_INCREMENT,
  `version` int(10) DEFAULT '1',
  `customer_id` int(10) NOT NULL,
  `uuid` varchar(36) NOT NULL,
  `phase` varchar(255) NOT NULL,
  `fqdn` varchar(255) NOT NULL,
  `region` varchar(255) NOT NULL,
  `release_version` varchar(255) NOT NULL,
  `cert_version` int(10) DEFAULT '0',
  PRIMARY KEY (`id`),
  UNIQUE KEY `fqdn` (`fqdn`),
  UNIQUE KEY `uuid` (`uuid`),
  FOREIGN KEY (`customer_id`) REFERENCES `customer_data` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE utf8_unicode_ci''',


    r'''CREATE TABLE IF NOT EXISTS `features` (
  `id` int(10) NOT NULL AUTO_INCREMENT,
  `du_id` int(10) NOT NULL,
  `feature` varchar(25) NOT NULL,
  `enabled` tinyint(1) DEFAULT '1',
  `version` int(10) DEFAULT '1',
  PRIMARY KEY (`id`),
  UNIQUE KEY `feature` (`du_id`, `feature`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE utf8_unicode_ci''',


    r'''CREATE TABLE IF NOT EXISTS `passwords` (
  `id` int(10) NOT NULL AUTO_INCREMENT,
  `du_id` int(10) NOT NULL,
  `name` varchar(255) NOT NULL,
  `value` varchar(50) NOT NULL,
  `version` int(10) DEFAULT '1',
  PRIMARY KEY (`id`),
  UNIQUE KEY `name` (`du_id`, `name`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE utf8_unicode_ci'''
]


def init_metadata_schema(db):
    with db.cursor() as cursor:
        for stmt in SQL_v1:
            cursor.execute(stmt)
